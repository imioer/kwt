# Vežbe | 10. termin

## DOM

> The [Document Object Model (DOM)](https://developer.mozilla.org/en-US/docs/Web/API/Document_Object_Model/Introduction) is the data representation of the objects that comprise the structure and content of a document on the web

### Rad sa elementima

#### Uzimanje postojeceg elementa

Dobijanje reference na element sa datim id-jem:
```js
let element = document.getElementById("id-1")
```

Dobijanje niza elemenata predstavljanih datim tagom:
```js
let urls = document.getElementsByTagName("a")
```

Dobijanje niza elemenata koji odgovaraju datom CSS selektoru:
```js
let cbList = document.querySelectorAll('input[type="checkbox"]')
```

ili jedan element koji odgovara CSS selektoru:
```js
let content = document.querySelector('body > div.main-content')
```

#### Kreiranje novog elementa

```js
let novi = document.createElement("button")
```

Nakon kreiranja element postoji u memoriji, imamo referencu na njega (`novi`), ali nije ukljucen u strukturu stranice.

Element se ukljucuje u stranicu (document) ubacivanjem u neki drugi element koji je vec na stranici:
```js
stari.appendChild(novi)
```

ili direktno u `body` element:
```js
document.body.appendChild(novi)
```

Takođe, element se moze ukloniti iz roditeljskog elementa (element nastavlja da postoji u memoriji, moze se ponovo dodati u stranicu):
```js
stari.removeChild(novi) // => referenca na uklonjeni elelent (novi)
```

ili se moze uništiti (više ne postoji u memoriji):
```js
novi.remove()
```

Referencom na novokreirani element se moze baratati na isti nacin kao i referencom na postojeci:
```js
novi.innerHTML = 'Dugme'
novi.className = 'my-btn-class'
novi.onclick = function() { /* ... */ }
// ...
```


## XHR
> XML HTTP Request (XHR)

`books.xml`
```xml
<library>
    <book>
        <title>Title 1<title>
        <author>Author 1<author>
    </book>
    <book>
        <title>Title 2<title>
        <author>Author 2<author>
    </book>
</library>
```

Slanje HTTP zahteva preko koga se dobijaju podaci iz trazenog fajla:
```js
let xhr = new XMLHttpRequest()       // Kreiranje objekta za slanje HTTP zahteva
xhr.open('GET', 'books.xml', false)  // GET   - dobavljanje podataka
xhr.send()                           // false - nije asinhrono (send() blokira dok podaci ne stignu)
xhr.responseXML                      // => XML dokument, sličan HTML dokumentu (document)
```
u `responseXML` se nalazi referenca na XML dokument koji sadrži XML elemente, slično kao što HTML dokument (`document`) sadrži HTML elemente, tako da možemo koristiti DOM funkcije kao što su `getElementById`, `getElementsByTagName` i `querySelector`.

Primer čitanja podataka iz dobijenog XML dokument objekta:
```js
let doc = xhr.responseXML                     // XML dokument objekat
let books = doc.getElementsByTagName('book')  // Lista book elemenata

let book = books[0] // Prvi book element

// Pristup child elementima preko DOM funkcija
book.getElementsByTagName('title')[0].textContent   // => "Title 1"
book.getElementsByTagName('author')[0].textContent  // => "Author 1"

// Pristup child elementima preko children niza
book.children[0].nodeName     // => "title"
book.children[0].textContent  // => "Title 1"
book.children[1].nodeName     // => "author"
book.children[1].textContent  // => "Author 1"
```

Kako bismo lakše baratali podacima iz dobijenog XML dokumenta, možemo ih izvući u obične objekte:

```js
let library = []
for (let book of books) 
{
    let bookObj = {
        title: book.getElementsByTagName('title')[0].textContent,
        author: book.getElementsByTagName('author')[0].textContent,
    }
    library.push(bookObj)
}
```

Ili možemo automatizovati izvlačenje podataka npr. na ovakav način:
```js
let library = []
for (let book of books) 
{
    let bookObj = {}
    for(let tag of book.children) {
        bookObj[tag.nodeName] = tag.textContent // npr: bookObj["title"] = "Title 1"
    }
    library.push(bookObj)
}
```

ideja je da za svaki "item" element (`book` u ovom slučaju) dobijemo elemente (tagove) koji predstavljaju njegove osobine ("title" i "author") i smestimo njihove vrednosti u objekat koji predstavlja taj jedan "item" (`book`).

Nakon izvršenog koda niz `library` će biti:
```js
// library niz:
[
    { title: 'Title 1', author: 'Authro 1' },
    { title: 'Title 2', author: 'Authro 2' }
]

// pristup podacima:
library[0].title  // => "Title 1"
library[0].author // => "Author 1"
```

### Asinhroni XHR zahtev




